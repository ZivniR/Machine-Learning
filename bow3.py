import json
import collections, re
import operator
from pprint import pprint
def Nonecheak(vals):
    if vals is None:
        vals = 0
    return vals

json_data = open("Video_Games_5.json").read()
with open('Sports_and_Outdoors_5.json', 'r') as handle:
    json_data = [json.loads(line) for line in handle]
i, j = 0, 0
right, wrong, overall = 0, 0, 0
stars = 1

grades = {'5stars': 0, '4stars': 0, '3stars': 0, '2stars': 0, '1stars': 0}
words = ['good', 'great', 'better', 'not', 'bad', 'worst', 'wonderfull', 'amazing', 'failure', 'hate', 'love', 'best', 'dumb', 'fan', 'fantastic', 'fine', 'cheap', 'impossible', 'fun', 'pleasing', 'like', 'unlike', 'very', 'well', 'off', 'awesome', 'beat', 'horrible', 'easy', 'right', 'wrong', 'perfect', 'worth', 'far', 'recommend', 'excellent', 'special', 'nothing', 'unique', 'nice', 'poor', 'terrible', 'crap', 'awful', 'didn', 'don', 'boring', 'annoying', 'cool', 'frustrating', 'enjoy', 'decent', 'stupid', 'lack', 'disappointed', 'super', 'waste', 'impossible', 'issues', 'limited', 'no', 'kill', 'pretty', 'hard', 'worth', 'original', 'problem', 'quite', 'hit', 'miss', 'problems', 'missing', 'greatest', 'yes', 'loved', 'fans', 'top', 'useless', 'despite', 'enjoyed', 'favorite', 'realistic', 'classic', 'fast', 'huge', 'slow', 'won', 'lose', 'interesting']
star5 = [0.0006771941736546939, 0.0004815976210783524, 0.0008347516209135642, 0.0011093563981026421, 0.0012305838263751271, 0.002419338982904121, 0.0003660796238567545, 0.00048762349875780114, 0.0017368963789911763, 0.000569415291172391, 0.0006349599404640132, 0.00044306479973338136, 0.0016438808233000027, 0.0008167403865831075, 0.00041617883217983113, 0.001069979611259815, 0.0011952445760249357, 0.0011735942611985398, 0.0005956972172060564, 0.0005464626919285216, 0.0008651476336200687, 0.0004899052724954892, 0.0007007698927485333, 0.0006631298802238898, 0.0010092374234192678, 0.0004335835776814736, 0.0009276941263572715, 0.0023353088169324283, 0.0005488107142220693, 0.0010122759656288197, 0.0011730364184788893, 0.00040221564564968566, 0.0008939640684904252, 0.0008871412446954932, 0.0006760965111835764, 0.00030067880703942457, 0.0005115478835329203, 0.0012758883938229356, 0.00035757548772545616, 0.000525906077936357, 0.001557921375541516, 0.0021629700484435905, 0.0025856526529895126, 0.002168587205446086, 0.0010005707953397666, 0.0011505089618058847, 0.0013416785454909742, 0.0008490281582863578, 0.0004918465432229638, 0.000885183132604849, 0.0006996732945793213, 0.0007145483878409942, 0.0017711354649245284, 0.0008676233314056441, 0.00041135427123795013, 0.0004798722015745861, 0.002671047792678385, 0.0011735942611985398, 0.001360294468926603, 0.0010282583077360085, 0.0012719665445319998, 0.0005857476121500944, 0.0005456725752834604, 0.0007809056262981162, 0.0008939640684904252, 0.0006540299541622218, 0.00108321787888202, 0.00040990843668263006, 0.0008860078783679348, 0.0006248695047911518, 0.0011802141630951524, 0.0008114624819162874, 0.0003890576774056322, 0.000935126368435388, 0.0008772698998143747, 0.0006327282091930528, 0.000812720672740787, 0.0014898782616034507, 0.0005492055979112683, 0.0006080977005981377, 0.0003660723309981403, 0.0005010123486830762, 0.00035374705637935926, 0.0007236741900559139, 0.0008130450497094127, 0.0010243375905842633, 0.0010597774245273243, 0.0010762206861834578, 0.0005506662510972026]
star4 = [0.0008757368707937298, 0.0006673564535565735, 0.0009736801261498319, 0.0010906303929023697, 0.0011950616421862164, 0.0011954877114693145, 0.0005180237727196081, 0.0006342596572055543, 0.0013174642347342277, 0.0013571790070033773, 0.0006944061428648963, 0.0005704884135527515, 0.001322165789377983, 0.0009042322706176547, 0.0006230830901662851, 0.0010429675986615493, 0.0011685181958939485, 0.0012068381598016478, 0.0008789388598048452, 0.000758870226209712, 0.0010232144534002186, 0.0006816737221494973, 0.0009714427424509913, 0.0008587584965384077, 0.0010445576960790538, 0.0006213620541294147, 0.0006446594036765272, 0.0013158393183272978, 0.0008122444579785359, 0.0010788176685877808, 0.0011373005606459148, 0.0005277001606759751, 0.0009413005346908403, 0.0010466351600301614, 0.0008769507681219769, 0.0005416063652780063, 0.0007544158288398172, 0.0012439047601304275, 0.0006503715391040847, 0.0008971023426417501, 0.0015024533172296594, 0.0014306858287114037, 0.0012970597442488422, 0.0013799623259828904, 0.0012405414068701677, 0.0011201212970513414, 0.0015967689267735237, 0.0012404650289942344, 0.0007829191047983623, 0.0013316872225044574, 0.0008825784768518996, 0.0011450276477763986, 0.0013348683396014302, 0.0012534039252446948, 0.002957562954624782, 0.0005176020774867087, 0.0012340799954500008, 0.0012068381598016478, 0.0013387326860159721, 0.0011368979970446552, 0.0012278776073143204, 0.0007556792181395583, 0.0010019948491677983, 0.00091830212030489, 0.0009413005346908403, 0.000750454988422462, 0.0011425015813464204, 0.0007059737044838883, 0.001102730653682329, 0.0010320291872731732, 0.0010563425924397297, 0.0009332541165440575, 0.00047987834011566755, 0.0009505160919449282, 0.0009411227920050194, 0.0007777296432456211, 0.000862694133190959, 0.0014324598059313976, 0.0008598662175654966, 0.0008668998880568299, 0.0005074224198744357, 0.0008514608099147751, 0.0004640910246631568, 0.0009785166231546885, 0.0009404035181927905, 0.0011461246057821886, 0.00091482547203405, 0.0010446636981735794, 0.0010338380690437482]
star3 = [0.0010479622029651208, 0.0008375641060883583, 0.0009756872377195383, 0.0009457330711888538, 0.0009655990658939612, 0.0007114043923997451, 0.0007411564207898621, 0.000643357526099678, 0.0007669239240755974, 0.0009956824334931447, 0.0007366331399728527, 0.0006941348009055491, 0.0007973896155662526, 0.0009085370880110035, 0.00080872665067125, 0.0009496514583852171, 0.0009702685538910073, 0.0009515340967830305, 0.0010028574904182256, 0.0011782689785778374, 0.0009520284541643516, 0.0008734085266555886, 0.0009558015914002258, 0.0009259166227433659, 0.0009427866154472764, 0.0006156539335361121, 0.0008760498015795926, 0.000644361217776545, 0.0010053446815130912, 0.0009059144942683476, 0.0009428363570033554, 0.0007010597015112799, 0.0009444117124700219, 0.0009986804967524567, 0.0008799225454427012, 0.0007535980945529288, 0.0009808565561847552, 0.0009465764335784949, 0.0008649325302573747, 0.0011901799064557316, 0.0008330260512994318, 0.0006579310149805349, 0.0006008273162992697, 0.0007180773727500766, 0.000959184439361719, 0.0009491727469889083, 0.0009147344355814769, 0.0011649609702826017, 0.0010011502892339806, 0.0011441792730070334, 0.0009869739170571257, 0.0012819083420371306, 0.0008284855782485785, 0.0011461287827582644, 0.0004572728419263667, 0.0006905338815992562, 0.0005076870368174638, 0.0009515340967830305, 0.000969120110821131, 0.0010128903578149983, 0.0008648168898662688, 0.0005590400376589084, 0.0011879851459218502, 0.0009653608244427854, 0.0009444117124700219, 0.0009488580888920015, 0.0010619383765631916, 0.001331229552861899, 0.0009370117559862806, 0.0009543571614085628, 0.0009337233659640285, 0.0011102978740570209, 0.0006975271662678998, 0.0009102633772914431, 0.0008135149707237224, 0.0010145478207316133, 0.0008255905450548595, 0.001038265062959456, 0.0011253939277674138, 0.0010739597876523227, 0.0006059818597166672, 0.0009564891534425789, 0.0006852556783273512, 0.0009707552047434079, 0.0008816775203988326, 0.0010238778075438884, 0.0009048363237120546, 0.0009307862401390547, 0.0011632650336843046]
star2 = [0.001070439700857588, 0.001136664339203592, 0.0009209172023849647, 0.0007652093427643373, 0.0006946688599183281, 0.0003221140901887361, 0.001103740374058292, 0.0009293938896327947, 0.0004576383293948581, 0.0007666391287639341, 0.0009057037972043864, 0.001017120847057669, 0.0005721714545405187, 0.0010037883124104808, 0.0010873798226774419, 0.000800864771396184, 0.0006290323911758867, 0.0007323447353715687, 0.001057253566295055, 0.0010697437800353574, 0.0008862680807955373, 0.0011762564818229536, 0.0009770760835822255, 0.0010375758195485623, 0.0008334667412441002, 0.0010109091669092299, 0.0009784555983363965, 0.0002991396915648223, 0.0011441932888325305, 0.0007643401570241532, 0.0006739587827220163, 0.0011940306082297181, 0.0009531301898488523, 0.0008220000566200635, 0.000909520106220405, 0.0013517659388498837, 0.0010466445799143375, 0.0005799320403738827, 0.0011536217695845062, 0.001100097703205637, 0.0004412711010101632, 0.0003183334204700331, 0.0003237667496867305, 0.0002956464877312908, 0.0007446940140781308, 0.0007993355673349639, 0.000465299722501242, 0.0008125882717101946, 0.0011078549161061936, 0.0007678356994723275, 0.0009784569459089663, 0.0008987913476125298, 0.00041863266934739674, 0.000787505014822481, 0.0003366295900263595, 0.0008782472374378602, 0.00025393214759622263, 0.0007323447353715687, 0.0005859440771630869, 0.0008321455448655304, 0.0006466579823492262, 0.0004883258004585461, 0.001014954492741611, 0.0009768537906907756, 0.0009531301898488523, 0.001009344890013842, 0.0007847519849964723, 0.001123916168700817, 0.0007785357510257324, 0.0009841315501076214, 0.0008371769477228108, 0.0008931887005927258, 0.0008832128267938981, 0.0008804301776861667, 0.0007675053876664923, 0.001115456502936359, 0.0008346301340165462, 0.0003897951346321753, 0.001115144046562057, 0.0011339913626383193, 0.0009779468758724515, 0.0012338193808366423, 0.0010225347644965757, 0.0009100765316436193, 0.0008914013522654296, 0.0007819348545601659, 0.0008604045473492688, 0.0007518337200938285, 0.0008948829061869705]
star1 = [0.0008637964717246505, 0.0015599724103435037, 0.0008826172704760467, 0.0007006624306732917, 0.0005042922941991868, 0.00015075286874442284, 0.00206629651624328, 0.002170276251358955, 0.0004319381640714622, 0.0008355833455430831, 0.0018332543719186897, 0.002105350054334875, 0.00031853211927897575, 0.0009759523455421181, 0.00179832322076847, 0.0007498531082673981, 0.0006616126118331334, 0.0005160315254619745, 0.001028901172576019, 0.0009676460037401013, 0.0008676608376959993, 0.00142466194364004, 0.0009762343395258182, 0.001124767239602135, 0.0007757089900877725, 0.002170391734264944, 0.0012885960423384842, 0.00020796158274324515, 0.001041710665874245, 0.0008771743033757119, 0.0007035973867579164, 0.0019477391123592614, 0.0008643246640782812, 0.0008353521097608468, 0.001332924082119787, 0.0017384497730349655, 0.0013298098801874062, 0.000579867181293787, 0.0016488352262972793, 0.0007451079908950001, 0.00029925088879384287, 0.0001886018382026454, 0.0, 0.00019449424854615002, 0.0006237441750159976, 0.0005655744055494135, 0.0002472414111180237, 0.0003879215048625116, 0.0011973136919071951, 0.0003213017720433537, 0.0010485320395676478, 0.0003650946131708064, 0.0003378153096909647, 0.0004136978780902852, 0.0002525132001791898, 0.002336719365240041, 0.00022782653872802468, 0.0005160315254619745, 0.00032391177284902064, 0.0005324971384218201, 0.0006310852711639167, 0.0004119196437211197, 0.0007020673160164541, 0.0009496187703033366, 0.0008643246640782812, 0.0012847319135668206, 0.0004623681493048334, 0.000882627583009378, 0.0009122995845867849, 0.0009671260993753151, 0.0005891054265525439, 0.0009262616163031186, 0.002464908815498456, 0.0009603153521966157, 0.0013320893914454946, 0.0010266888542294526, 0.0013927641598389033, 0.0002369199059695598, 0.0008436510468103955, 0.0008211851902691211, 0.0024530827808586816, 0.0009852788706940093, 0.002346001346785614, 0.001014730667444788, 0.0010379493720908573, 0.0005784960975967294, 0.0009133608842057564, 0.0008370696685596558, 0.0008629860935280397]

mylist=[]
#while j < len(json_data):
while j < 1000:
    if int((json_data)[i]['overall']) == stars:
        mylist.append(str(json_data[i]['reviewText']).lower())
        j+=1
        print(j)

        bagsofwords = [ collections.Counter(re.findall(r'\w+', txt))
                    for txt in mylist ]
    #print("1")
        sumbags = sum(bagsofwords, collections.Counter())
        summary=0
        amount= sumbags.values()
        for ob1 in amount:
            summary= ob1 + summary

    #print(sumbags)
        print("go")
        for obj in bagsofwords:
            k=0
            while k< len(words):
                val=obj.get(words[k])
                val=Nonecheak(val)
                if val > 0:
                    grades['5stars'] += (star5[k] *val)
                    grades['4stars'] += (star4[k] *val)
                    grades['3stars'] += (star3[k] *val)
                    grades['2stars'] += (star2[k] *val)
                    grades['1stars'] += (star1[k] *val)
                k+=1

            val1 = obj.get('fail')
            val1 = Nonecheak(val1)
            val2 = obj.get('failed')
            val2 = Nonecheak(val2)
            val =  val1+val2
            if val > 0:
                grades['5stars'] += (1 * val)
                grades['4stars'] += (2 * val)
                grades['3stars'] += (3 * val)
                grades['2stars'] += (4 * val)
                grades['1stars'] += (5 * val)
        print(grades)

        if grades['5stars'] > grades['4stars'] and grades['5stars'] > grades['3stars'] and grades['5stars'] > grades['2stars'] and grades['5stars'] > grades['1stars']:
            print("*****")
            overall = 5
        if grades['4stars'] > grades['5stars'] and grades['4stars'] > grades['3stars'] and grades['4stars'] > grades['2stars'] and grades['4stars'] > grades['1stars']:
            print("****")
            overall = 4
        if grades['3stars'] > grades['4stars'] and grades['3stars'] > grades['5stars'] and grades['3stars'] > grades['2stars'] and grades['3stars'] > grades['1stars']:
            print("***")
            overall = 3
        if grades['2stars'] > grades['4stars'] and grades['2stars'] > grades['3stars'] and grades['2stars'] > grades['5stars'] and grades['2stars'] > grades['1stars']:
            print("**")
            overall = 2
        if grades['1stars'] > grades['4stars'] and grades['1stars'] > grades['3stars'] and grades['1stars'] > grades['2stars'] and grades['5stars'] < grades['1stars']:
            print("*")
            overall = 1
        mylist.clear()
        bagsofwords.clear()
        grades={x: 0 for x in grades}
        if overall == int((json_data)[i]['overall']):
            right+=1
        else:
            wrong+=1

    i += 1
print("right:"+str(right)+" wrong:"+str(wrong))

ob=open('scores.txt','w')
ob.write("right:"+str(right)+" wrong:"+str(wrong)+" stars="+str(stars))